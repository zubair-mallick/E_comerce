import{j as e,D as V,E as Y,H as Z,d as ee,n as se,I as te,r as d,J as ie,K as ne,M as re,N as oe,O as o,m as ce,P as le,Q as de,_ as O,f as ae,T as ue,U as he}from"./index-43G1P5X5.js";import{B as P,I as xe,$ as je}from"./index-BPWA7iqB.js";import{r as _}from"./features-BjRR1Pe-.js";import{A as pe}from"./index-D4DqmvuM.js";const T=({value:i=0})=>{const{Ratings:l}=P({IconFilled:e.jsx(V,{}),IconOutline:e.jsx(Y,{}),value:i,styles:{fontSize:"1.75rem",color:"coral",justifyContent:"flex-start",gap:"1px"}});return e.jsx(l,{})},Ce=()=>{var v,w,R,b,y,C,k,S,F,I,N;const i=Z(),l=ee(),{user:n}=se(t=>t.userReducer),{isLoading:A,isError:E,data:s}=te(i.id),[H,x]=d.useState(!1),[c,j]=d.useState(1),u=ie(i.id),[p,m]=d.useState(""),h=d.useRef(null),[M,g]=d.useState(!1),[Q]=ne(),[$]=re(),B=()=>{c>0&&j(t=>t-1)},z=()=>{var t,r;((t=s==null?void 0:s.product)==null?void 0:t.stock)>c?j(a=>a+1):O.error(`${(r=s==null?void 0:s.product)==null?void 0:r.stock} available only`)},U=t=>{if(t.stock<1)return O.error("Out of Stock");l(ae(t))};if(E)return e.jsx(oe,{to:"/404"});const X=()=>{var t;(t=h.current)==null||t.showModal()},{Ratings:q,rating:J,setRating:K}=P({IconFilled:e.jsx(ue,{}),IconOutline:e.jsx(he,{}),value:0,selectable:!0,styles:{fontSize:"1.75rem",color:"coral",justifyContent:"flex-start"}}),f=()=>{var t;(t=h.current)==null||t.close(),K(0),m("")},W=async t=>{t.preventDefault(),g(!0),f();const r=await Q({comment:p,rating:J,userId:n==null?void 0:n._id,productId:i.id});g(!1),_(r,null,"")},G=async t=>{const r=await $({reviewId:t,userId:n==null?void 0:n._id});_(r,null,"")};return e.jsxs("div",{className:"product-details",children:[A?e.jsx(ge,{}):e.jsx(e.Fragment,{children:e.jsxs("main",{children:[e.jsxs("section",{children:[e.jsx(xe,{showThumbnails:!0,showNav:!1,onClick:()=>x(!0),images:((v=s==null?void 0:s.product)==null?void 0:v.photos)||[]}),H&&e.jsx(je,{NextButton:fe,PrevButton:ve,setIsOpen:x,images:((w=s==null?void 0:s.product)==null?void 0:w.photos)||[]})]}),e.jsxs("section",{children:[e.jsx("code",{children:(R=s==null?void 0:s.product)==null?void 0:R.category}),e.jsx("h1",{children:(b=s==null?void 0:s.product)==null?void 0:b.name}),e.jsx("div",{children:e.jsxs("em",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[e.jsx(T,{value:((y=s==null?void 0:s.product)==null?void 0:y.ratings)||5}),"(",(C=s==null?void 0:s.product)==null?void 0:C.numOfReviews," reviews)"]})}),e.jsxs("h3",{children:["â‚¹",(k=s==null?void 0:s.product)==null?void 0:k.price]}),e.jsxs("article",{children:[e.jsxs("div",{children:[e.jsx("button",{disabled:c===0,onClick:B,children:"-"}),e.jsx("span",{children:c}),e.jsx("button",{disabled:c===((S=s==null?void 0:s.product)==null?void 0:S.stock),onClick:z,children:"+"})]}),c===((F=s==null?void 0:s.product)==null?void 0:F.stock)&&e.jsx("p",{className:"red",children:"stock limit reached"}),e.jsx("button",{onClick:()=>{var t,r,a,D,L;return U({productId:(t=s==null?void 0:s.product)==null?void 0:t._id,name:(r=s==null?void 0:s.product)==null?void 0:r.name,price:(a=s==null?void 0:s.product)==null?void 0:a.price,stock:(D=s==null?void 0:s.product)==null?void 0:D.stock,quantity:c,photos:((L=s==null?void 0:s.product)==null?void 0:L.photos)||[]})},children:"Add To Cart"})]}),e.jsx("p",{children:(I=s==null?void 0:s.product)==null?void 0:I.description})]})]})}),e.jsxs("dialog",{ref:h,className:"review-dialog",children:[e.jsx("button",{onClick:f,children:"X"}),e.jsx("h2",{children:"Write a Review"}),e.jsxs("form",{onSubmit:W,children:[e.jsx("textarea",{value:p,onChange:t=>m(t.target.value),placeholder:"Review..."}),e.jsx(q,{}),e.jsx("button",{disabled:M,type:"submit",children:"Submit"})]})]}),e.jsxs("section",{children:[e.jsxs("article",{children:[e.jsx("h2",{children:"Reviews"}),u.isLoading?null:n&&e.jsx("button",{onClick:X,children:e.jsx(pe,{})})]}),e.jsx("div",{style:{display:"flex",gap:"2rem",overflowX:"auto",padding:"2rem"},children:u.isLoading?e.jsxs(e.Fragment,{children:[e.jsx(o,{width:"45rem",length:5}),e.jsx(o,{width:"45rem",length:5}),e.jsx(o,{width:"45rem",length:5})]}):(N=u.data)==null?void 0:N.reviews.map(t=>e.jsx(me,{handleDeleteReview:G,userId:n==null?void 0:n._id,review:t},t._id))})]})]})},me=({review:i,userId:l,handleDeleteReview:n})=>e.jsx("div",{className:"review-container",children:e.jsxs("div",{className:"review",children:[e.jsx(T,{value:i.rating}),e.jsx("p",{children:i.comment}),e.jsxs("div",{children:[e.jsx("img",{src:i.user.photo,alt:"User"}),e.jsx("small",{children:i.user.name})]}),l===i.user._id&&e.jsx("button",{onClick:()=>n(i._id),children:e.jsx(ce,{})})]})}),ge=()=>e.jsxs("div",{style:{display:"flex",gap:"2rem",border:"1px solid #f1f1f1",height:"80vh"},children:[e.jsx("section",{style:{width:"100%",height:"100%"},children:e.jsx(o,{width:"100%",containerHeight:"100%",height:"100%",length:1})}),e.jsxs("section",{style:{width:"100%",display:"flex",flexDirection:"column",gap:"4rem",padding:"2rem"},children:[e.jsx(o,{width:"40%",length:3}),e.jsx(o,{width:"50%",length:4}),e.jsx(o,{width:"100%",length:2}),e.jsx(o,{width:"100%",length:10})]})]}),fe=({onClick:i})=>e.jsx("button",{onClick:i,className:"carousel-btn",children:e.jsx(le,{})}),ve=({onClick:i})=>e.jsx("button",{onClick:i,className:"carousel-btn",children:e.jsx(de,{})});export{Ce as default};
